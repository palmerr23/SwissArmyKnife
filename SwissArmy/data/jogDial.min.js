!function(t,e){"use strict";var n=function(t,e){return new n.Instance(t,e||{})};function o(t,o,i){o*=n.ToRad;var r=Math.cos(o)*t.radius+t.center.x,s=Math.sin(o)*t.radius+t.center.y,l=n.utils.getQuadrant(r,s);n.utils.convertUnitToClock(o);t.knob.style.left=r+"px",t.knob.style.top=s+"px",t.knob.rotation==e&&n.utils.extend(t.knob,{rotation:t.opt.degreeStartAt,degree:n.utils.convertUnitToClock(o)}),i&&(t.info.now=n.utils.extend({},{rotation:i,quadrant:l}),t.info.old=n.utils.extend({},{rotation:i%360,quadrant:l}),n.utils.extend(t.knob,{rotation:i,degree:i%360})),n.utils.triggerEvent(t.knob,n.CustomEvent.MOUSE_MOVE)}n.Instance=function(i,r){return i.getAttribute("_jogDial_")?(t.alert("Please Check your code:\njogDial can not be initialized twice in a same element."),!1):(n.Ready||(n.Doc=t.document,n.ToRad=Math.PI/180,n.ToDeg=180/Math.PI,n.ModernEvent=!!n.Doc.addEventListener,n.MobileRegEx="/Mobile|iP(hone|od|ad)|Android|BlackBerry|IEMobile|Kindle|NetFront|Silk-Accelerated|(hpw|web)OS|Fennec|Minimo|Opera M(obi|ini)|Blazer|Dolfin|Dolphin|Skyfire|Zune/",n.MobileEvent="ontouchstart"in t&&t.navigator.userAgent.match(n.MobileRegEx),n.PointerEvent=!(!t.navigator.pointerEnabled&&!t.navigator.msPointerEnabled),n.Defaults={debug:!1,touchMode:"knob",knobSize:"30%",wheelSize:"100%",zIndex:9999,degreeStartAt:0,minDegree:null,maxDegree:null},n.DegInfo={rotation:0,quadrant:1},n.DomEvent={MOUSE_DOWN:"mousedown",MOUSE_MOVE:"mousemove",MOUSE_OUT:"mouseout",MOUSE_UP:"mouseup"},n.CustomEvent={MOUSE_DOWN:"mousedown",MOUSE_MOVE:"mousemove",MOUSE_UP:"mouseup"},n.utils={extend:function(t,e){for(var n in e)t[n]=e[n];return t},getComputedStyle:function(e,n){return t.getComputedStyle?t.getComputedStyle(e).getPropertyValue(n):e.currentStyle?e.currentStyle[n]:void 0},getCoordinates:function(e){var o=((e=e||t.event).target||e.srcElement).getBoundingClientRect();return{x:(n.MobileEvent?e.targetTouches[0].clientX:e.clientX)-o.left,y:(n.MobileEvent?e.targetTouches[0].clientY:e.clientY)-o.top}},getQuadrant:function(t,e){return t>0&&e>0?4:t<0&&e>0?3:t<0&&e<0?2:t>=0&&e<0?1:void 0},getRotation:function(t,e,n){var o,i=0,r=t.info;return 1==e&&2==r.old.quadrant?i=360:2==e&&1==r.old.quadrant&&(i=-360),o=n+i-r.old.rotation+r.now.rotation,r.old.rotation=n,r.old.quadrant=e,o},checkBoxCollision:function(t,e){return t.x1<e.x&&t.x2>e.x&&t.y1<e.y&&t.y2>e.y},addEvent:function(t,e,n,o){e=e.split(" ");for(var i=0;i<e.length;i++)t.addEventListener?t.addEventListener(e[i],n,o):t.attachEvent&&t.attachEvent("on"+e[i],n)},removeEvent:function(t,e,n){e=e.split(" ");for(var o=0;o<e.length;o++)t.addEventListener?t.removeEventListener(e[o],n):t.detachEvent&&t.detachEvent("on"+e[o],n)},triggerEvent:function(t,e){var o;n.Doc.createEvent?((o=n.Doc.createEvent("HTMLEvents")).initEvent(e,!0,!0),t.dispatchEvent(o)):((o=n.Doc.createEventObject()).target={},n.utils.extend(o.target,t),t.fireEvent("on"+e,o))},convertClockToUnit:function(t){return t%360-90},convertUnitToClock:function(t){return t>=-180&&t<-90?450+t:90+t}},n.Ready=!0),function(t,e,o){t.base=e,t.base.setAttribute("_JogDial_",!0),t.opt=n.utils.extend(n.utils.extend({},n.Defaults),o),t.info={}||t,t.info.now=n.utils.extend({},n.DegInfo),t.info.old=n.utils.extend({},n.DegInfo),t.info.snapshot=n.utils.extend({},t.info),t.info.snapshot.direction=null}(this,i,r),function(t){var e,o,i,r,s={},l=t.base.getAttribute("id"),a=t.base.clientWidth,u=t.base.clientHeight,d=t.opt,c=s.knob=document.createElement("div"),f=s.wheel=document.createElement("div"),v=c.style,h=f.style;"static"===n.utils.getComputedStyle(t.base,"position")&&(t.base.style.position="relative");t.base.appendChild(c),t.base.appendChild(f),n.utils.extend(t,s),v.position=h.position="absolute",v.width=v.height=d.knobSize,h.width=h.height=d.wheelSize,e=c.clientWidth/2,o=f.clientWidth/2,c.setAttribute("id",l+"_knob"),v.margin=-e+"px 0 0 "+-e+"px",v.zIndex=d.zIndex,f.setAttribute("id",l+"_wheel"),i=(a-f.clientWidth)/2,r=(u-f.clientHeight)/2,h.left=h.top=0,h.margin=r+"px 0 0 "+i+"px",h.zIndex=d.zIndex,t.radius=o-e,t.center={x:o+i,y:o+r},d.debug&&function(t){var e=t.knob.style,n=t.wheel.style;e.backgroundColor="#00F",n.backgroundColor="#0F0",e.opacity=n.opacity=.4,e.filter=n.filter="progid:DXImageTransform.Microsoft.Alpha(Opacity=40)",e.webkitBorderRadius=n.webkitBorderRadius="50%",e.borderRadius=n.borderRadius="50%"}(t)}(this),function(t){n.PointerEvent?n.utils.extend(n.DomEvent,{MOUSE_DOWN:"pointerdown MSPointerDown",MOUSE_MOVE:"pointermove MSPointerMove",MOUSE_OUT:"pointerout MSPointerOut",MOUSE_UP:"pointerup pointercancel MSPointerUp MSPointerCancel"}):n.MobileEvent&&n.utils.extend(n.DomEvent,{MOUSE_DOWN:"touchstart",MOUSE_MOVE:"touchmove",MOUSE_OUT:"touchleave",MOUSE_UP:"touchend"});var i=t.opt,r=t.info,s=t.knob,l=t.wheel;function a(s){if(t.pressed){s.preventDefault?s.preventDefault():s.returnValue=!1;var a,u=n.utils.getCoordinates(s),d=u.x-t.center.x+l.offsetLeft,c=u.y-t.center.y+l.offsetTop,f=Math.atan2(c,d)*n.ToDeg,v=n.utils.getQuadrant(d,c),h=n.utils.convertUnitToClock(f);r.now.rotation=n.utils.getRotation(t,v==e?r.old.quadrant:v,h),a=r.now.rotation,null!=i.maxDegree&&i.maxDegree<=a?(null==r.snapshot.direction&&(r.snapshot.direction="right",r.snapshot.now=n.utils.extend({},r.now),r.snapshot.old=n.utils.extend({},r.old)),a=i.maxDegree,f=n.utils.convertClockToUnit(a),h=n.utils.convertUnitToClock(f)):null!=i.minDegree&&i.minDegree>=a?(null==r.snapshot.direction&&(r.snapshot.direction="left",r.snapshot.now=n.utils.extend({},r.now),r.snapshot.old=n.utils.extend({},r.old)),a=i.minDegree,f=n.utils.convertClockToUnit(a),h=n.utils.convertUnitToClock(f)):null!=r.snapshot.direction&&(r.snapshot.direction=null),n.utils.extend(t.knob,{rotation:a,degree:h}),o(t,f)}}function u(){t.pressed&&(t.pressed=!1,null!=t.info.snapshot.direction&&(t.info.now=n.utils.extend({},r.snapshot.now),t.info.old=n.utils.extend({},r.snapshot.old),t.info.snapshot.direction=null),n.utils.triggerEvent(t.knob,n.CustomEvent.MOUSE_UP))}t.pressed=!1,n.utils.addEvent(l,n.DomEvent.MOUSE_DOWN,function(e){switch(i.touchMode){case"knob":default:t.pressed=n.utils.checkBoxCollision({x1:s.offsetLeft-l.offsetLeft,y1:s.offsetTop-l.offsetTop,x2:s.offsetLeft-l.offsetLeft+s.clientWidth,y2:s.offsetTop-l.offsetTop+s.clientHeight},n.utils.getCoordinates(e));break;case"wheel":t.pressed=!0,a(e)}t.pressed&&n.utils.triggerEvent(t.knob,n.CustomEvent.MOUSE_DOWN)},!1),n.utils.addEvent(l,n.DomEvent.MOUSE_MOVE,a,!1),n.utils.addEvent(l,n.DomEvent.MOUSE_UP,u,!1),n.utils.addEvent(l,n.DomEvent.MOUSE_OUT,u,!1)}(this),o(this,n.utils.convertClockToUnit(this.opt.degreeStartAt)),this)},n.Instance.prototype={on:function(t,e){return n.utils.addEvent(this.knob,t,e,!1),this},off:function(t,e){return n.utils.removeEvent(this.knob,t,e),this},trigger:function(e,i){switch(e){case"angle":o(this,n.utils.convertClockToUnit(i),i);break;default:t.alert("Please Check your code:\njogDial does not have triggering event ["+e+"]")}return this},angle:function(t){o(this,n.utils.convertClockToUnit(t),t)}},"function"==typeof define&&define.amd?define(function(){return n}):"object"==typeof exports?module.exports=n:t.JogDial=n}(window);
